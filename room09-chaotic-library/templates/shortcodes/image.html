{%- set image_classes = [] -%}
{%- if full -%}
	{%- set image_classes = image_classes | concat(with="full") -%}
{%- endif -%}
{%- if full_bleed -%}
	{%- set image_classes = image_classes | concat(with="full-bleed") -%}
{%- endif -%}
{%- if start -%}
	{%- set image_classes = image_classes | concat(with="start") -%}
{%- endif -%}
{%- if end -%}
	{%- set image_classes = image_classes | concat(with="end") -%}
{%- endif -%}
{%- if pixels -%}
	{%- set image_classes = image_classes | concat(with="pixels") -%}
{%- endif -%}
{%- if transparent -%}
	{%- set image_classes = image_classes | concat(with="transparent") -%}
{%- endif -%}
{%- if not hover -%}
	{%- set image_classes = image_classes | concat(with="no-hover") -%}
{%- endif -%}
{%- if spoiler -%}
	{%- set image_classes = image_classes | concat(with="spoiler") -%}
{%- endif -%}
{%- if spoiler and solid -%}
	{%- set image_classes = image_classes | concat(with="solid") -%}
{%- endif -%}

{%- set image_classes = image_classes | join(sep=" ") -%}
{%- if width or height -%}
    {%- set format = format | default(value="webp") -%}
    {%- set quality = quality | default(value=100) -%}

    {%- if width and height -%}
        {%- set image = resize_image(path=url, op="fit", width=width, height=height, format=format, quality=quality) -%}
    {%- elif width -%}
        {%- set image = resize_image(path=url, op="fit_width", width=width, format=format, quality=quality) -%}
    {%- elif height -%}
        {%- set image = resize_image(path=url, op="fit_height", height=height, format=format, quality=quality) -%}
    {%- endif -%}
    {%- set url_min = image.url -%}
{%- endif -%}

{%- if not full_size -%}
    {%- set url = url_min -%}
{%- else -%}
    {%- set url = get_url(path=url) -%}
{%- endif -%}

{%- if url_min and full_size -%}
	<a href="{{ url }}">
		<img class="{{ image_classes }}" {%- if alt -%}alt="{{ alt }}"{%- endif -%} src="{{ url_min }}" {%- if config.markdown.lazy_async_image -%}decoding="async" loading="lazy"{%- endif -%} />
	</a>
{%- else -%}
	<img class="{{ image_classes }}" {%- if alt -%}alt="{{ alt }}"{%- endif -%} src="{{ url }}" {%- if config.markdown.lazy_async_image -%}decoding="async" loading="lazy"{%- endif -%} />
{%- endif -%}
